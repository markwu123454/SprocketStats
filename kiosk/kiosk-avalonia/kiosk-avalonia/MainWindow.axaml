<Window
    x:Class="kiosk_avalonia.MainWindow"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:kiosk_avalonia"
    Title="SprocketStats Analytics"
    WindowState="FullScreen"
    SystemDecorations="None"
    Background="#1B1D1F"
    Foreground="#E6E6E6">

    <!-- ================= RESOURCES ================= -->

    <Window.Resources>
        <!-- Core colors -->
        <SolidColorBrush x:Key="Surface" Color="#121416" />
        <SolidColorBrush x:Key="BorderSoft" Color="#2A2D30" />

        <SolidColorBrush x:Key="TextSecondary" Color="#9AA0A6" />

        <!-- Accents -->
        <SolidColorBrush x:Key="TerminalGreen" Color="#00FF6F" />
        <SolidColorBrush x:Key="DangerRed" Color="#E81123" />
    </Window.Resources>

    <!-- ================= LAYOUT ================= -->

    <Grid Margin="24" ColumnDefinitions="2.2*,*">

        <!-- ================= LEFT PANE ================= -->

        <Grid Grid.Column="0" Margin="0,0,16,0"
              RowDefinitions="Auto,*,Auto">

            <!-- Header -->
            <TextBlock Text="Console"
                       FontSize="16"
                       FontWeight="SemiBold"
                       Foreground="{StaticResource TextSecondary}"
                       Margin="0,0,0,8" />

            <!-- Log Output -->
            <Border Grid.Row="1"
                    Background="{StaticResource Surface}"
                    BorderBrush="{StaticResource BorderSoft}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="12">

                <ScrollViewer x:Name="LogScrollViewer" VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="LogLines">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="app:ConsoleLine">
                                <ItemsControl ItemsSource="{Binding Spans}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>

                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate x:DataType="app:ConsoleSpan">
                                            <TextBlock
                                                Text="{Binding Text}"
                                                Foreground="{Binding Foreground}"
                                                FontFamily="Consolas"
                                                FontSize="13" />
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Border>

            <!-- Command Entry -->
            <DockPanel Grid.Row="2" Margin="0,12,0,0">

                <TextBlock Text=">>>"
                           FontFamily="Consolas"
                           FontSize="16"
                           Foreground="{StaticResource TerminalGreen}"
                           VerticalAlignment="Center"
                           Margin="0,0,8,0" />

                <TextBox x:Name="CommandInput"
                         FontFamily="Consolas"
                         FontSize="14"
                         KeyDown="CommandInput_KeyDown" />
            </DockPanel>
        </Grid>

        <!-- ================= RIGHT PANE ================= -->

        <Grid Grid.Column="1" RowDefinitions="*,Auto">

            <!-- ================= SETTINGS ================= -->

            <Grid Grid.Row="0" Margin="0,0,0,16"
                  RowDefinitions="Auto,*">

                <TextBlock Text="Settings"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="{StaticResource TextSecondary}"
                           Margin="0,0,0,8" />

                <Border Grid.Row="1"
                        Background="{StaticResource Surface}"
                        BorderBrush="{StaticResource BorderSoft}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="12">

                    <app:SettingsView />
                </Border>
            </Grid>

            <!-- ================= ACTIONS ================= -->

            <StackPanel Grid.Row="1">

                <TextBlock Text="Actions"
                           FontSize="16"
                           FontWeight="SemiBold"
                           Foreground="{StaticResource TextSecondary}"
                           Margin="0,0,0,8" />

                <Border Background="{StaticResource Surface}"
                        BorderBrush="{StaticResource BorderSoft}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="12">

                    <StackPanel Spacing="8">

                        <Button x:Name="UploadBtn"
                                Content="Download Data"
                                Classes="Raised"
                                Click="Download_Click" />

                        <Button x:Name="RunBtn"
                                Content="Run Calculation"
                                Classes="Raised"
                                Click="Run_Click" />

                        <Button x:Name="DownloadBtn"
                                Content="Upload Results"
                                Classes="Raised"
                                Click="Upload_Click" />

                        <Button Content="Exit"
                                Classes="Text"
                                Foreground="{StaticResource DangerRed}"
                                Click="Exit_Click" />

                    </StackPanel>
                </Border>
            </StackPanel>

        </Grid>
    </Grid>
</Window>